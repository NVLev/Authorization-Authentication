# Custom Authentication & Authorization System

> Backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π (RBAC)

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–°–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –≥–∏–±–∫—É—é –º–æ–¥–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ä–µ—Å—É—Ä—Å–∞–º, –≥–¥–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è:
- **–†–æ–ª—è–º–∏** (admin, manager, user)
- **–†–µ—Å—É—Ä—Å–∞–º–∏** (projects, users, access_rules)
- **–ü—Ä–∞–≤–∏–ª–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞** (read, create, update, delete —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º "–≤—Å–µ/—Ç–æ–ª—å–∫–æ —Å–≤–æ–∏")

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (access + refresh —Ç–æ–∫–µ–Ω—ã)  
‚úÖ –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π –∏ –ø—Ä–∞–≤ (RBAC)  
‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ "—Å–≤–æ–∏/–≤—Å–µ –æ–±—ä–µ–∫—Ç—ã" (owner-based access)  
‚úÖ Soft delete –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (`is_active=False`)  
‚úÖ API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∞–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è admin)  
‚úÖ Mock-endpoints –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã  
‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (Swagger UI)  
‚úÖ Async/await –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞  

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```
users ‚Üê‚Üí user_roles ‚Üê‚Üí roles
                         ‚Üì
                    access_rules
                         ‚Üì
                 business_elements
                 
users ‚Üí refresh_tokens
users ‚Üí projects (owner_id)
```

### –¢–∞–±–ª–∏—Ü—ã –ë–î

| –¢–∞–±–ª–∏—Ü–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| **users** | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã (email, pass_hash, is_active) |
| **roles** | –†–æ–ª–∏ (admin, manager, user) |
| **user_roles** | Many-to-many —Å–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–æ–ª–µ–π |
| **business_elements** | –†–µ—Å—É—Ä—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (projects, users, access_rules) |
| **access_rules** | –ü—Ä–∞–≤–∏–ª–∞ –¥–æ—Å—Ç—É–ø–∞: —Ä–æ–ª—å ‚Üí —Ä–µ—Å—É—Ä—Å ‚Üí –ø—Ä–∞–≤–∞ |
| **refresh_tokens** | JWT refresh —Ç–æ–∫–µ–Ω—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–π |
| **projects** | –î–µ–º–æ-—Ä–µ—Å—É—Ä—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∞–≤ |

### –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

–ö–∞–∂–¥–∞—è **—Ä–æ–ª—å** –∏–º–µ–µ—Ç –Ω–∞–±–æ—Ä **–ø—Ä–∞–≤** –Ω–∞ –∫–∞–∂–¥—ã–π **—Ä–µ—Å—É—Ä—Å**:

| –ü—Ä–∞–≤–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| `read_permission` | –ß—Ç–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ **—Å–≤–æ–∏—Ö** –æ–±—ä–µ–∫—Ç–æ–≤ |
| `read_all_permission` | –ß—Ç–µ–Ω–∏–µ **–≤—Å–µ—Ö** –æ–±—ä–µ–∫—Ç–æ–≤ |
| `create_permission` | –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ |
| `update_permission` | –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ **—Å–≤–æ–∏—Ö** –æ–±—ä–µ–∫—Ç–æ–≤ |
| `update_all_permission` | –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ **–≤—Å–µ—Ö** –æ–±—ä–µ–∫—Ç–æ–≤ |
| `delete_permission` | –£–¥–∞–ª–µ–Ω–∏–µ **—Å–≤–æ–∏—Ö** –æ–±—ä–µ–∫—Ç–æ–≤ |
| `delete_all_permission` | –£–¥–∞–ª–µ–Ω–∏–µ **–≤—Å–µ—Ö** –æ–±—ä–µ–∫—Ç–æ–≤ |

### –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤ –ø–æ —Ä–æ–ª—è–º

| –†–æ–ª—å | –†–µ—Å—É—Ä—Å: projects | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------------------|----------|
| **Admin** | `read_all`, `create`, `update_all`, `delete_all` | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –ø—Ä–æ–µ–∫—Ç–∞–º |
| **Manager** | `read_all`, `create`, `update` (—Å–≤–æ–∏), `delete` (—Å–≤–æ–∏) | –í–∏–¥–∏—Ç –≤—Å–µ –ø—Ä–æ–µ–∫—Ç—ã, —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ |
| **User** | `read` (—Å–≤–æ–∏), `create`, `update` (—Å–≤–æ–∏), `delete` (—Å–≤–æ–∏) | –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ —Å–≤–æ–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.11+
- Docker & Docker Compose
- Poetry (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone https://github.com/NVLev/EM_Test_Task
cd EM_Test_Task
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–° Poetry:**
```bash
poetry install
poetry shell
```

**–ë–µ–∑ Poetry:**
```bash
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.template`:
```bash
cp .env.template .env
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `.env`:**
```env
# PostgreSQL
POSTGRES_DB=auth_system
POSTGRES_USER=auth_user
POSTGRES_PASSWORD=your_secure_password

# JWT
APP_CONFIG__AUTH__SECRET_KEY=your-secret-key-here  # –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ: openssl rand -hex 32
APP_CONFIG__AUTH__ALGORITHM=HS256
APP_CONFIG__AUTH__ACCESS_EXPIRE_MINUTES=30
APP_CONFIG__AUTH__REFRESH_EXPIRE_DAYS=7

# Database URL
APP_CONFIG__DB__URL=postgresql+asyncpg://auth_user:your_secure_password@localhost:5432/auth_system
```

### 4. –ó–∞–ø—É—Å–∫ PostgreSQL
```bash
docker-compose up -d
```

–ü—Ä–æ–≤–µ—Ä–∫–∞:
```bash
docker-compose ps
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: auth_postgres (healthy)
```

### 5. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
```bash
alembic upgrade head
```

### 6. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
```bash
python seed_data.py
```

**–ë—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã:**
- `admin@test.com` / `admin123` (—Ä–æ–ª—å: admin)
- `manager@test.com` / `manager123` (—Ä–æ–ª—å: manager)
- `user@test.com` / `user123` (—Ä–æ–ª—å: user)

### 7. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
uvicorn main:app --reload
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: **http://localhost:8000**

Swagger UI: **http://localhost:8000/docs**

---

## üìö API Endpoints

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (`/auth`)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ | –î–æ—Å—Ç—É–ø |
|-------|----------|----------|--------|
| POST | `/auth/register` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –ü—É–±–ª–∏—á–Ω—ã–π |
| POST | `/auth/login` | –í—Ö–æ–¥ (–ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤) | –ü—É–±–ª–∏—á–Ω—ã–π |
| POST | `/auth/refresh` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access —Ç–æ–∫–µ–Ω–∞ | –¢—Ä–µ–±—É–µ—Ç—Å—è refresh token |
| POST | `/auth/logout` | –í—ã—Ö–æ–¥ (–æ—Ç–∑—ã–≤ refresh —Ç–æ–∫–µ–Ω–∞) | –¢—Ä–µ–±—É–µ—Ç—Å—è refresh token |
| GET | `/auth/me` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ | –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è |

### üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ (`/admin`)

**–î–æ—Å—Ç—É–ø: —Ç–æ–ª—å–∫–æ admin**

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/admin/roles` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ä–æ–ª–µ–π |
| POST | `/admin/roles` | –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ä–æ–ª–∏ |
| GET | `/admin/resources` | –°–ø–∏—Å–æ–∫ –±–∏–∑–Ω–µ—Å-—ç–ª–µ–º–µ–Ω—Ç–æ–≤ (—Ä–µ—Å—É—Ä—Å–æ–≤) |
| POST | `/admin/resources` | –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞ |
| GET | `/admin/rules` | –°–ø–∏—Å–æ–∫ –ø—Ä–∞–≤–∏–ª –¥–æ—Å—Ç—É–ø–∞ |
| POST | `/admin/rules` | –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–æ—Å—Ç—É–ø–∞ |
| PATCH | `/admin/rules/{id}` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–æ—Å—Ç—É–ø–∞ |

### üì¶ –î–µ–º–æ-—Ä–µ—Å—É—Ä—Å—ã (`/projects`)

**–î–æ—Å—Ç—É–ø: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–æ–ª–∏**

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/projects/` | –°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ (—Å —É—á—ë—Ç–æ–º –ø—Ä–∞–≤) |
| POST | `/projects/` | –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ |
| GET | `/projects/{id}` | –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ |
| PATCH | `/projects/{id}` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ (—Ç–æ–ª—å–∫–æ —Å–≤–æ–π/–≤—Å–µ) |
| DELETE | `/projects/{id}` | –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ (—Ç–æ–ª—å–∫–æ —Å–≤–æ–π/–≤—Å–µ) |

---

## üß™ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥

**–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:**
```bash
curl -X POST http://localhost:8000/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email": "newuser@test.com", "password": "password123"}'
```

**–í—Ö–æ–¥:**
```bash
curl -X POST http://localhost:8000/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email": "admin@test.com", "password": "admin123"}'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer"
}
```

### 2. –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏

**–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:**
```bash
curl -X POST http://localhost:8000/projects/ \
  -H "Authorization: Bearer <access_token>" \
  -H "Content-Type: application/json" \
  -d '{"title": "My Project", "description": "Test project"}'
```

**–°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤:**
```bash
curl -X GET http://localhost:8000/projects/ \
  -H "Authorization: Bearer <access_token>"
```

### 3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∞–º–∏ (—Ç–æ–ª—å–∫–æ admin)

**–°–ø–∏—Å–æ–∫ –ø—Ä–∞–≤–∏–ª –¥–æ—Å—Ç—É–ø–∞:**
```bash
curl -X GET http://localhost:8000/admin/rules \
  -H "Authorization: Bearer <admin_access_token>"
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
# 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ë–î –∑–∞–ø–æ–ª–Ω–µ–Ω–∞
python seed_data.py --force

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã
pytest -v
```

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Swagger

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000/docs
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/auth/login` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **üîì Authorize** –≤–≤–µ—Ä—Ö—É —Å–ø—Ä–∞–≤–∞
4. –í—Å—Ç–∞–≤—å—Ç–µ `access_token`
5. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ endpoints —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–æ–ª—è–º–∏!

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|------------|
| **FastAPI** | –í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ |
| **SQLAlchemy 2.0** | ORM (async) |
| **Alembic** | –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| **PostgreSQL** | –†–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –ë–î |
| **asyncpg** | Async –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è PostgreSQL |
| **Pydantic** | –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö |
| **python-jose** | JWT —Ç–æ–∫–µ–Ω—ã |
| **bcrypt** | –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π |
| **pytest** | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
| **Docker** | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è |

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
EM_Test_Task/
‚îú‚îÄ‚îÄ core/                   # –Ø–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ config.py          # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ .env
‚îÇ   ‚îú‚îÄ‚îÄ db_helper.py       # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ë–î —Å–µ—Å—Å–∏—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ models.py          # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ schemas.py         # Pydantic —Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ services/              # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ auth_service.py    # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (JWT, –ø–∞—Ä–æ–ª–∏)
‚îÇ   ‚îî‚îÄ‚îÄ authz_service.py   # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤)
‚îú‚îÄ‚îÄ routes/                # API endpoints
‚îÇ   ‚îú‚îÄ‚îÄ auth.py            # /auth/* (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω)
‚îÇ   ‚îú‚îÄ‚îÄ admin.py           # /admin/* (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∞–º–∏)
‚îÇ   ‚îî‚îÄ‚îÄ mock_resources.py  # /projects/* (–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è)
‚îú‚îÄ‚îÄ middleware/            # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Å–ª–æ–∏
‚îÇ   ‚îî‚îÄ‚îÄ permissions.py     # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
‚îú‚îÄ‚îÄ tests/                 # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py        # –§–∏–∫—Å—Ç—É—Ä—ã pytest
‚îÇ   ‚îú‚îÄ‚îÄ test_auth.py       # –¢–µ—Å—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ test_authz.py      # –¢–µ—Å—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ test_admin.py      # –¢–µ—Å—Ç—ã admin API
‚îú‚îÄ‚îÄ alembic/               # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îú‚îÄ‚îÄ main.py                # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îú‚îÄ‚îÄ seed_data.py           # –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
‚îú‚îÄ‚îÄ docker-compose.yml     # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ pyproject.toml         # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Poetry)
‚îî‚îÄ‚îÄ README.md              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ **bcrypt**
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
- ‚úÖ Refresh —Ç–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ—Ç–∑—ã–≤–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ middleware
- ‚úÖ Soft delete –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–µ —É–¥–∞–ª—è–µ–º –∏–∑ –ë–î)

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –†–∞–±–æ—Ç–∞ —Å –ë–î
```bash
# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
python seed_data.py --force

# –û—á–∏—Å—Ç–∏—Ç—å –ë–î
python seed_data.py --clear

# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é
alembic revision --autogenerate -m "Description"

# –û—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
alembic downgrade -1
```

### –†–∞–±–æ—Ç–∞ —Å Docker
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ë–î
docker-compose restart

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker-compose logs -f pg

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î
docker exec -it auth_postgres psql -U auth_user -d auth_system
```

---

## üéì –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### –°–æ–≥–ª–∞—Å–Ω–æ —Ç–µ—Å—Ç–æ–≤–æ–º—É –∑–∞–¥–∞–Ω–∏—é:

‚úÖ **1. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º**
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (email, –ø–∞—Ä–æ–ª—å)
- Login/Logout
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è (`/auth/me`)
- –ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (`is_active=False`)

‚úÖ **2. –°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞**
- –¢–∞–±–ª–∏—Ü—ã: `roles`, `business_elements`, `access_rules`
- –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤ (read/create/update/delete)
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ "–≤—Å–µ/—Ç–æ–ª—å–∫–æ —Å–≤–æ–∏" –æ–±—ä–µ–∫—Ç—ã
- API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª–∞–º–∏ (admin)

‚úÖ **3. Mock-–æ–±—ä–µ–∫—Ç—ã –±–∏–∑–Ω–µ—Å-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
- `/projects/*` endpoints
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- –í–æ–∑–≤—Ä–∞—Ç 401/403 –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø—Ä–∞–≤

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

‚úÖ Refresh —Ç–æ–∫–µ–Ω—ã (JWT)  
‚úÖ Swagger UI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è  
‚úÖ Async/await –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞  
‚úÖ Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ  
‚úÖ –¢–µ—Å—Ç—ã (pytest)  

---

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏ Python Backend Developer

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License